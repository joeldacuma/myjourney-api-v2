(self.webpackChunkmyjourney_api_v_2=self.webpackChunkmyjourney_api_v_2||[]).push([[4263],{64797:(e,t,r)=>{"use strict";var a=r(25108),n=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(r(87757)),s=n(r(67154)),l=n(r(48926)),i=n(r(53547)),u=r(39711),d=r(97132),c=n(r(45697)),f=n(r(78718)),p=n(r(27361)),m=n(r(57557)),g=r(68547),v=r(23724),b=r(80831),y=r(5493),h=r(19408),w=r(34626),O=r(78862),E=r(85104),M=r(49425),P=r(62031),j=r(9008),k=n(r(68717)),_=n(r(84734)),S=r(26595),x=r(50289),A=n(r(59015)),L=r(37108),U=n(r(22849)),I=window&&window.strapi&&window.strapi.isEE?r(43685).Z:r(84768).Z,T=["email","firstname","lastname","username","isActive","roles"],C=function(e){var t=e.canUpdate,r=(0,d.useIntl)().formatMessage,n=(0,u.useRouteMatch)("/settings/users/:id").params.id,c=(0,u.useHistory)().push,C=(0,g.useAppInfos)().setUserDisplayName,D=(0,g.useNotification)(),B=(0,g.useOverlayBlocker)(),z=B.lockApp,W=B.unlockApp;(0,g.useFocusWhenNavigate)();var q=(0,v.useQuery)(["user",n],(function(){return(0,x.fetchUser)(n)}),{retry:!1,keepPreviousData:!1,staleTime:2e4,onError:function(e){403===e.response.status&&(D({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}}),c("/")),a.log(e.response.status)}}),R=q.status,N=q.data,F=function(){var e=(0,l.default)(o.default.mark((function e(t,a){var s,l,i,u,d;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(),e.prev=1,e.next=4,(0,x.putUser)(n,(0,m.default)(t,"confirmPassword"));case 4:s=e.sent,D({type:"success",message:r({id:"notification.success.saved",defaultMessage:"Saved"})}),l=g.auth.getUserInfo(),n.toString()===l.id.toString()&&(g.auth.setUserInfo(s),i=(0,p.default)(t,"username")||(0,S.getFullName)(t.firstname,t.lastname),C(i)),a.setValues((0,f.default)(t,T)),e.next=17;break;case 11:e.prev=11,e.t0=e.catch(1),u=(0,S.formatAPIErrors)(e.t0.response.data),d=Object.keys(u).reduce((function(e,t){return e[t]=u[t].id,e}),{}),a.setErrors(d),D({type:"warning",message:(0,p.default)(e.t0,"response.data.message","notification.error")});case 17:W();case 18:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,r){return e.apply(this,arguments)}}(),G="success"!==R,Z=G?{id:"app.containers.Users.EditPage.header.label-loading",defaultMessage:"Edit user"}:{id:"app.containers.Users.EditPage.header.label",defaultMessage:"Edit {name}"},V=Object.keys((0,f.default)(N,T)).reduce((function(e,t){return"roles"===t?(e[t]=((null===N||void 0===N?void 0:N.roles)||[]).map((function(e){return e.id})),e):(e[t]=null===N||void 0===N?void 0:N[t],e)}),{}),H=V.username||(0,S.getFullName)(V.firstname,V.lastname),Y=r(Z,{name:H});return G?i.default.createElement(P.Main,{"aria-busy":"true"},i.default.createElement(g.SettingsPageTitle,{name:"Users"}),i.default.createElement(O.HeaderLayout,{primaryAction:i.default.createElement(h.Button,{disabled:!0,startIcon:i.default.createElement(_.default,null),type:"button",size:"L"},r({id:"form.button.save",defaultMessage:"Save"})),title:Y,navigationAction:i.default.createElement(E.Link,{startIcon:i.default.createElement(k.default,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},r({id:"app.components.go-back",defaultMessage:"Go back"}))}),i.default.createElement(O.ContentLayout,null,i.default.createElement(g.LoadingIndicatorPage,null))):i.default.createElement(P.Main,null,i.default.createElement(g.SettingsPageTitle,{name:"Users"}),i.default.createElement(b.Formik,{onSubmit:F,initialValues:V,validateOnChange:!1,validationSchema:L.editValidation},(function(e){var a=e.errors,n=e.values,o=e.handleChange,l=e.isSubmitting;return i.default.createElement(g.Form,null,i.default.createElement(O.HeaderLayout,{primaryAction:i.default.createElement(h.Button,{disabled:l||!t,startIcon:i.default.createElement(_.default,null),loading:l,type:"submit",size:"L"},r({id:"form.button.save",defaultMessage:"Save"})),title:Y,navigationAction:i.default.createElement(E.Link,{startIcon:i.default.createElement(k.default,null),to:"/settings/users?pageSize=10&page=1&sort=firstname"},r({id:"app.components.go-back",defaultMessage:"Go back"}))}),i.default.createElement(O.ContentLayout,null,(null===N||void 0===N?void 0:N.registrationToken)&&i.default.createElement(y.Box,{paddingBottom:6},i.default.createElement(I,{registrationToken:N.registrationToken})),i.default.createElement(j.Stack,{size:7},i.default.createElement(y.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},i.default.createElement(j.Stack,{size:4},i.default.createElement(M.Typography,{variant:"delta",as:"h2"},r({id:"app.components.Users.ModalCreateBody.block-title.details",defaultMessage:"Details"})),i.default.createElement(w.Grid,{gap:5},A.default.map((function(e){return e.map((function(e){return i.default.createElement(w.GridItem,(0,s.default)({key:e.name},e.size),i.default.createElement(g.GenericInput,(0,s.default)({},e,{disabled:!t,error:a[e.name],onChange:o,value:n[e.name]||""})))}))}))))),i.default.createElement(y.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},i.default.createElement(j.Stack,{size:4},i.default.createElement(M.Typography,{variant:"delta",as:"h2"},r({id:"app.components.Users.ModalCreateBody.block-title.login",defaultMessage:"Login settings"})),i.default.createElement(w.Grid,{gap:5},i.default.createElement(w.GridItem,{col:6,xs:12},i.default.createElement(U.default,{disabled:!t,error:a.roles,onChange:o,value:n.roles}))))))))})))};C.propTypes={canUpdate:c.default.bool.isRequired};var D=C;t.default=D},50289:(e,t,r)=>{"use strict";var a=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.putUser=t.fetchUser=void 0;var n=a(r(87757)),o=a(r(48926)),s=r(53777),l=function(){var e=(0,o.default)(n.default.mark((function e(t){var r,a;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.axiosInstance.get("/admin/users/".concat(t));case 2:return r=e.sent,a=r.data,e.abrupt("return",a.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();t.fetchUser=l;var i=function(){var e=(0,o.default)(n.default.mark((function e(t,r){var a,o;return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.axiosInstance.put("/admin/users/".concat(t),r);case 2:return a=e.sent,o=a.data,e.abrupt("return",o.data);case 5:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}();t.putUser=i},59015:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=[[{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},name:"firstname",placeholder:{id:"Auth.form.firstname.placeholder",defaultMessage:"e.g. Kai"},type:"text",size:{col:6,xs:12}},{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},name:"lastname",placeholder:{id:"Auth.form.lastname.placeholder",defaultMessage:"e.g. Doe"},type:"text",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},name:"email",placeholder:{id:"Auth.form.email.placeholder",defaultMessage:"e.g. kai.doe@strapi.io"},type:"email",size:{col:6,xs:12}},{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},name:"username",placeholder:{id:"Auth.form.username.placeholder",defaultMessage:"e.g. Kai_Doe"},type:"email",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.password.label",defaultMessage:"Password"},name:"password",type:"password",size:{col:6,xs:12}},{intlLabel:{id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"},name:"confirmPassword",type:"password",size:{col:6,xs:12}}],[{intlLabel:{id:"Auth.form.active.label",defaultMessage:"Active"},name:"isActive",type:"bool",size:{col:6,xs:12}}]];t.default=r},20262:(e,t,r)=>{"use strict";var a=r(95318),n=r(50008);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var r=c(t);if(r&&r.has(e))return r.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var l=o?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(a,s,l):a[s]=e[s]}a.default=e,r&&r.set(e,a);return a}(r(53547)),s=r(68547),l=r(39711),i=r(96486),u=a(r(13240)),d=a(r(64797));function c(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(c=function(e){return e?r:t})(e)}var f=function(){var e=(0,s.useNotification)(),t=(0,o.useMemo)((function(){return{read:u.default.settings.users.read,update:u.default.settings.users.update}}),[]),r=(0,s.useRBAC)(t),a=r.isLoading,n=r.allowedActions,c=n.canRead,f=n.canUpdate,p=(0,l.useLocation)().state,m=(0,i.get)(p,"from","/");return(0,o.useEffect)((function(){a||c||f||e({type:"info",message:{id:"notification.permission.not-allowed-read",defaultMessage:"You are not allowed to see this document"}})}),[a,c,f,e]),a?o.default.createElement(s.LoadingIndicatorPage,null):c||f?o.default.createElement(d.default,{canUpdate:f}):o.default.createElement(l.Redirect,{to:m})};t.default=f},38059:(e,t,r)=>{"use strict";var a=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(53547)),o=a(r(45697)),s=r(30741),l=r(68547),i=a(r(67483)),u=r(74855),d=r(97132),c=function(){return n.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg"},n.default.createElement("text",{transform:"translate(-23 -9)",fill:"#4B515A",fillRule:"evenodd",fontSize:"32",fontFamily:"AppleColorEmoji, Apple Color Emoji"},n.default.createElement("tspan",{x:"23",y:"36"},"\u2709\ufe0f")))},f=function(e){var t=e.children,r=e.target,a=(0,l.useNotification)(),o=(0,(0,d.useIntl)().formatMessage)({id:"app.component.CopyToClipboard.label",defaultMessage:"Copy to clipboard"});return n.default.createElement(l.ContentBox,{endAction:n.default.createElement(u.CopyToClipboard,{onCopy:function(){a({type:"info",message:{id:"notification.link-copied"}})},text:r},n.default.createElement(s.IconButton,{label:o,noBorder:!0,icon:n.default.createElement(i.default,null)})),title:r,titleEllipsis:!0,subtitle:t,icon:n.default.createElement(c,null),iconBackground:"neutral100"})};f.propTypes={children:o.default.oneOfType([o.default.element,o.default.string]).isRequired,target:o.default.string.isRequired};var p=f;t.default=p},84768:(e,t,r)=>{"use strict";var a=r(95318);t.Z=void 0;var n=a(r(53547)),o=r(97132),s=a(r(45697)),l=a(r(92424)),i=a(r(38059)),u=function(e){var t=e.registrationToken,r=(0,o.useIntl)().formatMessage,a="".concat(window.location.origin).concat(l.default,"auth/register?registrationToken=").concat(t);return n.default.createElement(i.default,{target:a},r({id:"app.components.Users.MagicLink.connect",defaultMessage:"Send this link to the user for them to connect."}))};u.defaultProps={registrationToken:""},u.propTypes={registrationToken:s.default.string};var d=u;t.Z=d},22849:(e,t,r)=>{"use strict";var a=r(95318),n=r(50008);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(r(87757)),s=a(r(48926)),l=a(r(53547)),i=a(r(45697)),u=r(97132),d=r(43808),c=r(23724),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var r=g(t);if(r&&r.has(e))return r.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var l=o?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(a,s,l):a[s]=e[s]}a.default=e,r&&r.set(e,a);return a}(r(78384)),p=a(r(57572)),m=r(53777);function g(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(g=function(e){return e?r:t})(e)}var v=(0,f.keyframes)(["from{transform:rotate(0deg);}to{transform:rotate(359deg);}"]),b=f.default.div.withConfig({displayName:"SelectRoles__LoadingWrapper",componentId:"sc-1z5s3s-0"})(["animation:"," 2s infinite linear;"],v),y=function(){return l.default.createElement(b,null,l.default.createElement(p.default,null))},h=function(){var e=(0,s.default)(o.default.mark((function e(){var t,r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.axiosInstance.get("/admin/roles");case 2:return t=e.sent,r=t.data,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(e){var t=e.disabled,r=e.error,a=e.onChange,n=e.value,o=(0,c.useQuery)(["roles"],h,{staleTime:5e4}),s=o.status,i=o.data,f=(0,u.useIntl)().formatMessage,p=r?f({id:r,defaultMessage:r}):"",m=f({id:"app.components.Users.ModalCreateBody.block-title.roles",defaultMessage:"User's roles"}),g=f({id:"app.components.Users.ModalCreateBody.block-title.roles.description",defaultMessage:"Your user can have one or several roles"}),v=f({id:"app.components.Select.placeholder",defaultMessage:"Select"}),b="loading"===s?l.default.createElement(y,null):void 0;return l.default.createElement(d.Select,{id:"roles",disabled:t,error:p,hint:g,label:m,name:"roles",onChange:function(e){a({target:{name:"roles",value:e}})},placeholder:v,multi:!0,startIcon:b,value:n,withTags:!0},(i||[]).map((function(e){return l.default.createElement(d.Option,{key:e.id,value:e.id},e.name)})))};w.defaultProps={disabled:!1,error:void 0},w.propTypes={disabled:i.default.bool,error:i.default.string,onChange:i.default.func.isRequired,value:i.default.array.isRequired};var O=w;t.default=O},33694:(e,t,r)=>{"use strict";var a=r(95318),n=r(50008);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=a(r(59713)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var r=u(t);if(r&&r.has(e))return r.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var l=o?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(a,s,l):a[s]=e[s]}a.default=e,r&&r.set(e,a);return a}(r(53209)),l=r(21600),i=a(r(20703));function u(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(u=function(e){return e?r:t})(e)}function d(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var f=s.object().shape(c(c({},l.commonUserSchema),{},{isActive:s.bool()},i.default));t.default=f},37108:(e,t,r)=>{"use strict";var a=r(95318);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"editValidation",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"profileValidation",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"rolesValidation",{enumerable:!0,get:function(){return s.default}});var n=a(r(33694)),o=a(r(21600)),s=a(r(20703))},21600:(e,t,r)=>{"use strict";var a=r(95318),n=r(50008);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.commonUserSchema=void 0;var o=a(r(59713)),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==n(e)&&"function"!==typeof e)return{default:e};var r=i(t);if(r&&r.has(e))return r.get(e);var a={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var l=o?Object.getOwnPropertyDescriptor(e,s):null;l&&(l.get||l.set)?Object.defineProperty(a,s,l):a[s]=e[s]}a.default=e,r&&r.set(e,a);return a}(r(53209)),l=r(68547);function i(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(i=function(e){return e?r:t})(e)}function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){(0,o.default)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var c={firstname:s.mixed().required(l.translatedErrors.required),lastname:s.mixed(),email:s.string().email(l.translatedErrors.email).lowercase().required(l.translatedErrors.required),username:s.string().nullable(),password:s.string().min(8,l.translatedErrors.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:s.string().min(8,l.translatedErrors.minLength).oneOf([s.ref("password"),null],"components.Input.error.password.noMatch").when("password",(function(e,t){return e?t.required(l.translatedErrors.required):t}))};t.commonUserSchema=c;var f=d(d({},c),{},{currentPassword:s.string().when(["password","confirmPassword"],(function(e,t,r){return e||t?r.required(l.translatedErrors.required):r})),preferedLanguage:s.string().nullable()});t.default=f},20703:(e,t,r)=>{"use strict";var a=r(50008);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!==typeof e)return{default:e};var r=s(t);if(r&&r.has(e))return r.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&Object.prototype.hasOwnProperty.call(e,l)){var i=o?Object.getOwnPropertyDescriptor(e,l):null;i&&(i.get||i.set)?Object.defineProperty(n,l,i):n[l]=e[l]}n.default=e,r&&r.set(e,n);return n}(r(53209)),o=r(68547);function s(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(s=function(e){return e?r:t})(e)}var l={roles:n.array().min(1,o.translatedErrors.required).required(o.translatedErrors.required)};t.default=l},43685:(e,t,r)=>{"use strict";var a=r(95318);t.Z=void 0;var n=a(r(53547)),o=r(97132),s=a(r(45697)),l=a(r(92424)),i=a(r(38059)),u=function(e){var t=e.registrationToken,r=(0,o.useIntl)().formatMessage;return t?n.default.createElement(i.default,{target:"".concat(window.location.origin).concat(l.default,"auth/register?registrationToken=").concat(t)},r({id:"app.components.Users.MagicLink.connect",defaultMessage:"Send this link to the user for them to connect."})):n.default.createElement(i.default,{target:"".concat(window.location.origin).concat(l.default,"auth/login")},r({id:"app.components.Users.MagicLink.connect.sso",defaultMessage:"Send this link to the user, the first login can be made via a SSO provider."}))};u.defaultProps={registrationToken:""},u.propTypes={registrationToken:s.default.string};var d=u;t.Z=d}}]);