(self.webpackChunkmyjourney_api_v_2=self.webpackChunkmyjourney_api_v_2||[]).push([[6750],{86297:(k,D,o)=>{"use strict";o.r(D),o.d(D,{default:()=>Be});var e=o(53547),L=o(49656),y=o(68547),H=o(37367),R=o.n(H),f=o(35395),X=o(92543),P=o(64459),z=o(89326),F=o.n(z),x=o(9524),q=o(11700),$=o.n(q);const _=()=>e.createElement("svg",{width:"159",height:"88",viewBox:"0 0 159 88",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M134.933 17.417C137.768 17.417 140.067 19.7153 140.067 22.5503C140.067 25.3854 137.768 27.6837 134.933 27.6837H105.6C108.435 27.6837 110.733 29.9819 110.733 32.817C110.733 35.6521 108.435 37.9503 105.6 37.9503H121.733C124.568 37.9503 126.867 40.2486 126.867 43.0837C126.867 45.9187 124.568 48.217 121.733 48.217H114.272C110.698 48.217 107.8 50.5153 107.8 53.3503C107.8 55.2404 109.267 56.9515 112.2 58.4837C115.035 58.4837 117.333 60.7819 117.333 63.617C117.333 66.4521 115.035 68.7503 112.2 68.7503H51.3333C48.4982 68.7503 46.2 66.4521 46.2 63.617C46.2 60.7819 48.4982 58.4837 51.3333 58.4837H22.7333C19.8982 58.4837 17.6 56.1854 17.6 53.3503C17.6 50.5153 19.8982 48.217 22.7333 48.217H52.0666C54.9017 48.217 57.2 45.9187 57.2 43.0837C57.2 40.2486 54.9017 37.9503 52.0666 37.9503H33.7333C30.8982 37.9503 28.6 35.6521 28.6 32.817C28.6 29.9819 30.8982 27.6837 33.7333 27.6837H63.0666C60.2316 27.6837 57.9333 25.3854 57.9333 22.5503C57.9333 19.7153 60.2316 17.417 63.0666 17.417H134.933ZM134.933 37.9503C137.768 37.9503 140.067 40.2486 140.067 43.0837C140.067 45.9187 137.768 48.217 134.933 48.217C132.098 48.217 129.8 45.9187 129.8 43.0837C129.8 40.2486 132.098 37.9503 134.933 37.9503Z",fill:"#DBDBFA"}),e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M95.826 16.6834L102.647 66.4348L103.26 71.4261C103.458 73.034 102.314 74.4976 100.706 74.695L57.7621 79.9679C56.1542 80.1653 54.6906 79.0219 54.4932 77.4139L47.8816 23.5671C47.7829 22.7631 48.3546 22.0313 49.1586 21.9326C49.1637 21.932 49.1688 21.9313 49.1739 21.9307L52.7367 21.5311L95.826 16.6834ZM55.6176 21.208L58.9814 20.8306Z",fill:"white"}),e.createElement("path",{d:"M55.6176 21.208L58.9814 20.8306M95.826 16.6834L102.647 66.4348L103.26 71.4261C103.458 73.034 102.314 74.4976 100.706 74.695L57.7621 79.9679C56.1542 80.1653 54.6906 79.0219 54.4932 77.4139L47.8816 23.5671C47.7829 22.7631 48.3546 22.0313 49.1586 21.9326C49.1637 21.932 49.1688 21.9313 49.1739 21.9307L52.7367 21.5311L95.826 16.6834Z",stroke:"#7E7BF6",strokeWidth:"2.5"}),e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M93.9695 19.8144L100.144 64.9025L100.699 69.4258C100.878 70.8831 99.8559 72.2077 98.416 72.3845L59.9585 77.1065C58.5185 77.2833 57.2062 76.2453 57.0272 74.7881L51.0506 26.112C50.9519 25.308 51.5236 24.5762 52.3276 24.4775L57.0851 23.8934",fill:"#F0F0FF"}),e.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M97.701 7.33301H64.2927C63.7358 7.33301 63.2316 7.55873 62.8667 7.92368C62.5017 8.28862 62.276 8.79279 62.276 9.34967V65.083C62.276 65.6399 62.5017 66.1441 62.8667 66.509C63.2316 66.874 63.7358 67.0997 64.2927 67.0997H107.559C108.116 67.0997 108.62 66.874 108.985 66.509C109.35 66.1441 109.576 65.6399 109.576 65.083V19.202C109.576 18.6669 109.363 18.1537 108.985 17.7755L99.1265 7.92324C98.7484 7.54531 98.2356 7.33301 97.701 7.33301Z",fill:"white",stroke:"#7F7CFA",strokeWidth:"2.5"}),e.createElement("path",{d:"M98.026 8.17871V16.6833C98.026 17.8983 99.011 18.8833 100.226 18.8833H106.044",stroke:"#807EFA",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}),e.createElement("path",{d:"M70.1594 56.2838H89.2261M70.1594 18.8838H89.2261H70.1594ZM70.1594 27.6838H101.693H70.1594ZM70.1594 37.2171H101.693H70.1594ZM70.1594 46.7505H101.693H70.1594Z",stroke:"#817FFA",strokeWidth:"2.5",strokeLinecap:"round",strokeLinejoin:"round"}));var p=o(43546),E=o(94117),ee=o(40264),g=o(33483),G=o(49549),te=o(19631),ne=o(46458),Z=o(99136),le=o(56204),ae=o.n(le),oe=o(62982),re=o.n(oe);function Re({value:t,checkboxID:n,callback:l,disabled:c}){const[a,u]=useState(t);function i(){u(!a),l&&l({id:n,value:!a})}return React.createElement(BaseCheckbox,{checked:a,onChange:i,disabled:c})}function Fe({value:t,onChange:n}){return React.createElement(TextInput,{type:"text","aria-label":"customAPI-input",name:"customAPI-input",onChange:n,value:t})}function ce({customAPIData:t,deleteCustomAPI:n,editCustomAPI:l,setShowCustomAPICustomizationPage:c}){return e.createElement(E.Box,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",padding:8,style:{marginTop:"10px"}},e.createElement(p.Table,{colCount:4,rowCount:10,footer:e.createElement(p.TFooter,{onClick:()=>c(!0),icon:e.createElement(F(),null)},"Add a CustomAPI")},e.createElement(p.Thead,null,e.createElement(p.Tr,null,e.createElement(p.Th,null,e.createElement(g.Typography,{variant:"sigma"},"ID")),e.createElement(p.Th,null,e.createElement(g.Typography,{variant:"sigma"},"Custom API Name")),e.createElement(p.Th,null,e.createElement(g.Typography,{variant:"sigma"},"Slug")),e.createElement(p.Th,null,e.createElement(te.VisuallyHidden,null,"Actions")))),e.createElement(p.Tbody,null,t.map(a=>e.createElement(p.Tr,{key:a.id},e.createElement(p.Td,null,e.createElement(g.Typography,{textColor:"neutral800"},a.id)),e.createElement(p.Td,null,e.createElement(g.Typography,{textColor:"neutral800"},a.name)),e.createElement(p.Td,null,e.createElement(g.Typography,{textColor:"neutral800"},a.slug)),e.createElement(p.Td,null,e.createElement(ee.Flex,{style:{justifyContent:"end"}},e.createElement(G.IconButton,{onClick:()=>l(a.id),label:"Edit",noBorder:!0,icon:e.createElement(ae(),null)}),e.createElement(E.Box,{paddingLeft:1},e.createElement(G.IconButton,{onClick:()=>n(a),label:"Delete",noBorder:!0,icon:e.createElement(re(),null)})))))))))}var ue=o(87760),ie=o.n(ue),se=o(22754),de=o.n(se),O=o(39272),me=o(53888),pe=o.n(me),fe=o(50361),ye=o.n(fe),S=(t,n,l)=>new Promise((c,a)=>{var u=r=>{try{s(l.next(r))}catch(m){a(m)}},i=r=>{try{s(l.throw(r))}catch(m){a(m)}},s=r=>r.done?c(r.value):Promise.resolve(r.value).then(u,i);s((l=l.apply(t,n)).next())});const T={getAllCustomApis:()=>S(void 0,null,function*(){return yield(0,y.request)("/custom-api/find",{method:"GET"})}),getCustomApiById:t=>S(void 0,null,function*(){return yield(0,y.request)(`/custom-api/find/${t}`,{method:"GET"})}),addCustomApi:t=>S(void 0,null,function*(){return yield(0,y.request)("/custom-api/create",{method:"POST",body:{data:t}})}),updateCustomApi:(t,n)=>S(void 0,null,function*(){return yield(0,y.request)(`/custom-api/update/${t}`,{method:"PUT",body:{data:n}})}),getAllContentTypes:()=>S(void 0,null,function*(){return yield(0,y.request)("/custom-api/content-types",{method:"GET"})})};var V=o(2632),M=o(47949),he=o(25108),ve=Object.defineProperty,Ee=Object.defineProperties,Ce=Object.getOwnPropertyDescriptors,I=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable,Y=(t,n,l)=>n in t?ve(t,n,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[n]=l,w=(t,n)=>{for(var l in n||(n={}))W.call(n,l)&&Y(t,l,n[l]);if(I)for(var l of I(n))U.call(n,l)&&Y(t,l,n[l]);return t},ge=(t,n)=>Ee(t,Ce(n)),Te=(t,n)=>{var l={};for(var c in t)W.call(t,c)&&n.indexOf(c)<0&&(l[c]=t[c]);if(t!=null&&I)for(var c of I(t))n.indexOf(c)<0&&U.call(t,c)&&(l[c]=t[c]);return l},A=(t,n,l)=>new Promise((c,a)=>{var u=r=>{try{s(l.next(r))}catch(m){a(m)}},i=r=>{try{s(l.throw(r))}catch(m){a(m)}},s=r=>r.done?c(r.value):Promise.resolve(r.value).then(u,i);s((l=l.apply(t,n)).next())});const Ae=({showCustomAPICustomizationPage:t,setShowCustomAPICustomizationPage:n,fetchData:l,isLoading:c})=>{const[a,u]=(0,e.useState)(""),[i,s]=(0,e.useState)(""),[r,m]=(0,e.useState)(null);(0,e.useEffect)(()=>A(void 0,null,function*(){const v=(yield T.getAllContentTypes()).map(C=>({uid:C.uid,displayName:C.info.displayName}));m(v)}),[]);const[h,N]=(0,e.useState)(),[B,j]=(0,e.useState)({populate:{table:"",fields:[]}});(0,e.useEffect)(()=>A(void 0,null,function*(){if(!t||!t.id)return;const d=yield T.getCustomApiById(t.id);d&&(u(d.name),s(d.slug),N(d.selectedContentType),j(d.structure))}),[]),(0,e.useEffect)(()=>A(void 0,null,function*(){if(t&&t.id||!h)return;const d=yield J({uid:h.uid});if(!d)return;const v=[],C={};yield K({currentContentTypeRaw:ye()(d),iteratedUIDs:v,reducedEntries:C}),C&&j(C)}),[h]);function De(d,v){const C=Pe(B,d,v);j(C)}const He=d=>A(void 0,null,function*(){d.preventDefault(),d.stopPropagation();try{t&&t.id?yield T.updateCustomApi(t.id,{name:a,slug:i,selectedContentType:h,structure:B}):yield T.addCustomApi({name:a,slug:i,selectedContentType:h,structure:B}),l(),n(!1)}catch(v){he.log("error",v)}});return e.createElement(e.Fragment,null,e.createElement(f.HeaderLayout,{id:"title",primaryAction:e.createElement(x.Stack,{horizontal:!0,spacing:2},e.createElement(P.Button,{startIcon:e.createElement(de(),null),onClick:He,type:"button",disabled:!1},"Save")),title:$()("Create a custom API"),subtitle:"creating a new custom API",navigationAction:e.createElement(P.Button,{onClick:()=>{n(!1)},startIcon:e.createElement(ie(),null),variant:"ghost",style:{paddingLeft:0}},"Back to list")}),e.createElement(f.ContentLayout,null,e.createElement(x.Stack,{spacing:4},e.createElement(E.Box,{padding:10,background:"neutral0",shadow:"filterShadow",hasRadius:!0},e.createElement(O.Grid,{gap:6},e.createElement(O.GridItem,{col:6,s:12},e.createElement(Z.TextInput,{placeholder:"A descriptive name",label:"Custom API Name",name:"name",hint:"A descriptive name",onChange:d=>u(d.target.value),value:a})),e.createElement(O.GridItem,{col:6,s:12},e.createElement(Z.TextInput,{placeholder:"A Slug for constructing URL",label:"Slug",name:"slug",hint:i&&`Get your data here: /custom-api/${i}`,onChange:d=>s(d.target.value),value:i}))))),e.createElement(E.Box,{padding:10,background:"neutral0",shadow:"filterShadow",hasRadius:!0,style:{marginTop:10}},e.createElement(x.Stack,{spacing:11},e.createElement(g.Typography,{variant:"beta"},"The selected Content Type is:"," ",h?h.displayName:""),e.createElement(V.Select,{id:"select1",label:"Choose the content-type",required:!0,placeholder:"select a content type",hint:"Relationships will automatically be mapped below",onClear:()=>N(void 0),clearLabel:"Clear content types",value:h?h.uid:null,disabled:!!(t&&t.id),onChange:d=>{N(r&&r.length&&r.filter(v=>v.uid===d)[0])}},r&&r.length&&r.map(d=>e.createElement(V.Option,{key:d.uid,value:d.uid},d.displayName))))),e.createElement(E.Box,{padding:10,background:"neutral0",shadow:"filterShadow",hasRadius:!0,style:{marginTop:10}},e.createElement(Q,{data:B.populate,toggleSelectedOfField:De}))))};function J(t){return A(this,arguments,function*({uid:n}){return(yield T.getAllContentTypes()).filter(a=>a.uid===n)[0]})}function K(t){return A(this,arguments,function*({currentContentTypeRaw:n,iteratedUIDs:l,reducedEntries:c,currentRelationalField:a}){let u={};l.push(n.uid),u.table=a||n.info.displayName,u.fields||(u.fields=[]);for(const i of Object.keys(n.attributes))if(n.attributes[i].type!=="relation"&&u.fields.push({selected:i==="id",name:i}),n.attributes[i].type==="relation"){const s=n.attributes[i].target;if(!l.includes(s)){const r=yield J({uid:s});yield K({currentContentTypeRaw:r,iteratedUIDs:l,reducedEntries:u,currentRelationalField:i})}}c.populate=u})}function Le(t){var n=t,{children:l,table:c}=n,a=Te(n,["children","table"]);const[u,i]=(0,e.useState)(!1);return e.createElement(M.Accordion,w({expanded:u,onToggle:()=>i(s=>!s),id:"acc-1",size:"S"},a),e.createElement(M.AccordionToggle,{title:c}),e.createElement(M.AccordionContent,null,e.createElement(E.Box,{padding:3},l)))}function Se({table:t,field:n,toggleSelectedOfField:l}){const[c,a]=(0,e.useState)(n.selected);return e.createElement(E.Box,null,e.createElement(ne.BaseCheckbox,{"aria-label":"fields checkbox",name:`base-checkbox-${t}-${n.name}`,id:`base-checkbox-${t}-${n.name}`,onValueChange:u=>{a(u),l(t,n.name)},value:c,disabled:n.name==="id"}),e.createElement("label",{style:{marginLeft:5},htmlFor:`base-checkbox-${t}-${n.name}`},n.name))}function Pe(t,n,l){return pe()(t,a=>{if(a&&a.table&&a.table===n){const i=[...a.fields].map(s=>s.name===l?{selected:!s.selected,name:s.name}:s);return ge(w({},a),{fields:i})}})}function Q({data:t,toggleSelectedOfField:n}){let{table:l,fields:c,populate:a}=t;return e.createElement(e.Fragment,null,e.createElement(E.Box,{padding:8,background:"neutral100"},e.createElement(Le,{table:l},e.createElement("ul",null,c.map(u=>e.createElement(Se,{key:u.name,table:l,field:u,toggleSelectedOfField:n})),a&&a.table&&e.createElement(Q,{data:a,toggleSelectedOfField:n})))))}const xe=Ae;var b=(t,n,l)=>new Promise((c,a)=>{var u=r=>{try{s(l.next(r))}catch(m){a(m)}},i=r=>{try{s(l.throw(r))}catch(m){a(m)}},s=r=>r.done?c(r.value):Promise.resolve(r.value).then(u,i);s((l=l.apply(t,n)).next())});const Ie=()=>{const[t,n]=(0,e.useState)(!0),[l,c]=(0,e.useState)([]),[a,u]=(0,e.useState)(!1),i=()=>b(void 0,null,function*(){t===!1&&n(!0);const m=yield T.getAllCustomApis();c(m),n(!1)});(0,e.useEffect)(()=>b(void 0,null,function*(){i()}),[]);function s(){return b(this,null,function*(){alert("Add functionality to delete the API")})}function r(m){return b(this,null,function*(){u({id:m})})}return t?e.createElement(y.LoadingIndicatorPage,null):e.createElement(f.Layout,null,e.createElement(f.BaseHeaderLayout,{title:"Custom API Builder Plugin",subtitle:"Visually build a custom API endpoint for any content type with fields nested any level deep",as:"h2"}),e.createElement(f.ContentLayout,null,l.length===0&&!a&&e.createElement(X.EmptyStateLayout,{icon:e.createElement(_,null),content:"You don't have any Custom API yet...",action:e.createElement(P.Button,{onClick:()=>u({id:null}),variant:"secondary",startIcon:e.createElement(F(),null)},"Add your first Custom API")}),l.length>0&&!a&&e.createElement(e.Fragment,null,e.createElement(f.HeaderLayout,{id:"title",primaryAction:e.createElement(x.Stack,{horizontal:!0,spacing:2},e.createElement(P.Button,{startIcon:e.createElement(F(),null),onClick:()=>{u({id:null})},type:"submit",disabled:!1},"Create new custom API")),title:$()(`custom  API${l.length>1?"s":""}`),subtitle:`${l.length} ${l.length>1?"entries":"entry"} found`}),e.createElement(f.ContentLayout,null,e.createElement(ce,{customAPIData:l,setShowCustomAPICustomizationPage:u,deleteCustomAPI:s,editCustomAPI:r}))),a&&e.createElement(xe,{showCustomAPICustomizationPage:a,setShowCustomAPICustomizationPage:u,isLoading:t,fetchData:i})))},be=(0,e.memo)(Ie),Be=()=>e.createElement("div",null,e.createElement(L.Switch,null,e.createElement(L.Route,{path:`/plugins/${R()}`,component:be,exact:!0}),e.createElement(L.Route,{component:y.NotFound})))},53888:(k,D,o)=>{var e=o(85990),L=1,y=4;function H(R,f){return f=typeof f=="function"?f:void 0,e(R,L|y,f)}k.exports=H}}]);
